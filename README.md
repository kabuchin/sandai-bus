# 産大バス時刻表

大阪産業大学のスクールバス（産大バス）の時刻表を確認できるWebアプリケーションです。リアルタイムで次のバスの時刻と到着までの残り時間を表示します。

# 産大バス時刻表

大阪産業大学のスクールバス（産大バス）の時刻表を確認できるWebアプリケーションです。リアルタイムで次のバスの時刻と到着までの残り時間を表示します。

## 機能

### 基本機能
- **リアルタイム表示**: 現在時刻に基づいて次のバスの時刻を自動で表示
- **双方向対応**: 産業大学前発とJR住道駅発の両方向のバス時刻に対応
- **残り時間表示**: 次のバスまでの残り時間を分単位で表示
- **今後の時刻表示**: 今後の発車時刻一覧を確認可能
- **ダイヤ判定**: 平日・土曜・夏季限定・無料乗車日・運休日を自動判定

### 新機能
- **手動日時設定**: 左上の日時エリア全体をタップして任意の日付・時間に設定可能
  - **リアルタイムプレビュー**: 入力中に設定される日時をプレビュー表示
  - **簡単切り替え**: 現在時刻と手動設定の間で簡単に切り替え
  - **入力検証**: 有効な日付・時刻のみ受け付け（1年前〜1年後の範囲）
  - **キーボード操作**: Enterキーやスペースキーでも操作可能
  - **視覚的フィードバック**: 手動設定時は日時エリアがオレンジ色で表示

### シェア機能
- **簡単共有**: 右上のメニューボタンで簡単にアプリを共有
- **URLコピー**: アイコンボタンでワンクリックコピー
- **QRコード**: QRコードを生成して共有・保存可能
- **QRダウンロード**: 生成したQRコードをPNG形式で保存
- **ネイティブ共有**: 対応デバイスでは端末の共有機能を利用

### ツールリンク
- **画像フォーマット変換**: 様々な画像形式への変換
- **画像からPDF変換**: 画像をPDFファイルに変換
- **関連サイト**: トップページやGitHubへのアクセス

### アクセシビリティ
- **キーボード操作**: 全ての機能がキーボードで操作可能
- **スクリーンリーダー対応**: 適切なARIA属性を設定
- **フォーカス管理**: モーダルの開閉時に適切にフォーカス移動

### レスポンシブデザイン
- **モバイル対応**: スマートフォンでの表示に最適化
- **ダークモード**: システムの設定に応じて自動切り替え
- **タッチ操作**: タップで詳細情報の開閉が可能

## 使い方

### 基本操作
1. ページを開くと自動で現在時刻のバス情報が表示されます
2. 次のバスと次々のバスの時刻が大きく表示されます
3. 「今後の発車時刻」をタップすると詳細な時刻表が開きます

### 日時設定機能
1. **左上の日時エリア全体をクリック**（またはEnter/スペースキー）してモーダルを開きます
2. 任意の**日付と時刻を入力**します（入力中にプレビューが表示されます）
3. 「この時刻で表示」ボタンで確定すると、その時刻でのバス情報が表示されます
4. 「現在時刻に戻す」ボタンで現在時刻に戻ります
5. Escキーまたはモーダル外をクリックしてキャンセルできます

### 手動設定時の表示
- 日時エリア全体が**オレンジ色の枠**で表示されます
- 自動更新は停止し、設定した時刻で固定されます

### シェア機能
1. **右上のメニューボタンをクリック**してメニューを開きます
2. **リンクセクション**: 関連サイトへのアクセス
3. **ツールセクション**: 便利なWebツールへのリンク
   - 画像フォーマット変換
   - 画像からPDFに変換
   - 産大バスの時刻表（このアプリ）
4. **共有セクション**: アイコンボタンで簡単共有
   - URLコピーアイコン: クリップボードにURLを直接コピー
   - QRコードアイコン: QRコードを生成して表示
   - 共有アイコン: 対応デバイスではネイティブ共有も利用可能

## 対応ダイヤ

### 平日ダイヤ
- **平日（月〜金）**: 通常の授業日程
- **平日臨時増便**: 新学期やイベント時の増便運行

### 土曜ダイヤ
- **土曜日**: 土曜授業日の運行

### 特別ダイヤ
- **夏季限定ダイヤ**: 夏季休暇期間中の限定運行
- **無料乗車日**: 大学祭などの特別イベント日
- **運休日**: 日曜日・祝日・長期休暇期間

## 技術改善

### パフォーマンス最適化
- **Debounce機能**: 入力中の処理を最適化
- **効率的な表示更新**: 必要な部分のみ更新
- **メモリリーク防止**: 適切なクリーンアップ処理

### コード品質
- **入力検証**: 堅牢なデータ検証機能
- **エラーハンドリング**: 包括的なエラー処理
- **モジュール化**: 機能ごとに分離された関数構成

### ファイル構成
```
├── index.html          # メインHTMLファイル
├── script.js           # JavaScript（メイン機能）
├── styles.css          # スタイルシート
├── time.json           # バス時刻表データ
├── day.json            # 特別ダイヤ設定
└── README.md           # このファイル
```

### データ形式
- **time.json**: 各ダイヤタイプの時刻表データ
- **day.json**: 年間の特別ダイヤスケジュール

### 外部ライブラリ
- **QRCode.js**: QRコード生成ライブラリ
- **Google Fonts**: Noto Sans JPフォント

### API利用
- **Web Share API**: ネイティブ共有機能（対応デバイスのみ）
- **Clipboard API**: URLコピー機能

### ブラウザ対応
- Chrome, Firefox, Safari, Edge の最新版
- iOS Safari, Android Chrome
- PWA（Progressive Web App）として動作可能

## カスタマイズ

### 時刻表データの更新
1. `time.json`で各ダイヤの時刻を編集
2. `day.json`で特別ダイヤの適用日を設定

### 表示設定の変更
- `upcomingBusCount`変数で表示する今後のバス本数を調整
- CSS変数でカラーテーマのカスタマイズが可能

## ライセンス

このプロジェクトは教育目的で作成されています。

## 貢献

バグ報告や機能要望は、GitHubのIssuesでお知らせください。

---

**注意**: このアプリケーションは非公式ツールです。実際のバス運行状況は大学の公式情報をご確認ください。